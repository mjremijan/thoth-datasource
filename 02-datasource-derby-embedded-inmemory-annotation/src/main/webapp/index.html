<!DOCTYPE html>
<html>
    <head>
        <title>02-datasource-derby-embedded-inmemory-annotation</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>
    <body>
        <h1>02-datasource-derby-embedded-inmemory-annotation</h1>
        <blockquote>
            <p>Welcome</p>
        </blockquote>
        
        
        <h1>Test Goals</h1>
        <blockquote>
            <p>Can the `@DataSourceDefinition` annotation be used to bind a
            `DataSource` to the `java:global/` namespace while creating
            an <b>embedded</b> and <b>in-memory</b> Derby database?
            </p>
        </blockquote>
        
        
        <h1>Test Results</h1>
        <blockquote>
            <p>Yes!</p>
            
            <p>
                For derby, it's a little tricky to configure the 
                `@DataSourceDefinition` annotation so that the database is 
                <b>in-memory</b> (not written to the file system). But
                here is what it looks like:
            </p>
            
            <blockquote>
                <p style='font-family: monospace;'>
                    @DataSourceDefinition(<br />
                    &nbsp;&nbsp;name = "java:global/ferris/ds/embedded-inmemory-annotation",<br />
                    &nbsp;&nbsp;className = "org.apache.derby.jdbc.EmbeddedDataSource",<br />
                    &nbsp;&nbsp;user="sa",<br />
                    &nbsp;&nbsp;password="sa",<br />
                    &nbsp;&nbsp;databaseName="memory:FuzzyLogicDB",<br />
                    &nbsp;&nbsp;properties = {"connectionAttributes=;create=true"}<br />
                    )
                </p>
            </blockquote>
            
            <p>
                Deploy this project.  Look at the
                `${com.sun.aas.instanceRoot}/logs/02-datasource-derby-embedded-inmemory-annotation.log`
                file. You will see a log message with some of the database's
                metadata which will look something like this:
            </p>
            
            <blockquote>
                <p>
                    2017-08-09 20:09:15 INFO  DataSourceDefinitionStartup:30 - <b>Product name: Apache
                    Derby, Product version: 10.10.2.0 - (1582446), Catalog term: CATALOG, URL: jdbc:
                    derby:memory:FuzzyLogicDB</b>
                </p>
            </blockquote>
        </blockquote>
    </body>
</html>
